
<%
scrollable = grid.column_names.size > 10
ui_grid_for grid,:scrollable =>scrollable do |g,cols,data|
  name_units = Rms::PerfType.index_units
%>
  <%g.head do %>
    <%g.r do%>
      <%@grid.column_names.each do |col|%>
        <%=g.format_sort col + (name_units[col[:name]].nil? ? "":"(#{name_units[col[:name]]})"), :html =>{:width =>scrollable ? 125 : nil,:onclick => "if(!this.href) return false;$(\"#query_condition\").attr(\"action\", this.href).submit();return false;"},
          :url =>{:action => controller.action_name,
          :sort => params[:sort],
        } %>
      <% end %>
    <% end %>
  <% end %>
  <%g.body :style => ("height:#{@kpilist_data && scrollable ? 300 : ''};word-wrap: break-word;") do %>
    <%#g.body :style => (@kpilist_data && scrollable ? "height:300px;" : "") do %>
    <%data.each do |d| %>
      <%g.r do%>
        <%cols.each do |col|%>
          <% if @report_type == 1 %>
            <%if col[:name].include?("占比") %>
              <%=g.d d[col[:name]].nil? ? "":'%.2f' % (d[col[:name]] * 100)+"%" %>
            <%#elsif col[:name].include?("数") %>
              <%#=g.d d[col[:name]].to_i %>
            <%elsif col[:name].include?("日期") %>
              <%=g.d d[col[:name]].to_s.to_date.strftime('%Y-%m-%d') %>
            <%else%>
              <%=g.d Procedure::DataFormater.format(col[:name], d[col[:name]])%>
            <%end%>
          <% else %>
            <%if col[:name].include?("占比") %>
              <%=g.d d[col[:name]].nil? ? "":'%.2f' % (d[col[:name]] * 100)+"%" %>
            <%elsif col[:name].include?("数") %>
              <%=g.d d[col[:name]].to_i %>
            <%elsif col[:name].include?("日期") %>
              <%=g.d d[col[:name]].to_s.to_date.strftime('%Y-%m-%d') %>
            <%else%>
              <%=g.d Procedure::DataFormater.format(col[:name], d[col[:name]])%>
            <%end%>
          <% end %>
        <% end %>
      <% end %>
    <% end %>
  <% end %>
<% end %>
